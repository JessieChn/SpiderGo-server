<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>详情页</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.3.3/dist/semantic.min.css"
          data-filtered="filtered">
    <link rel="stylesheet" href="../static/css/me.css" th:href="@{/css/me.css}">
    <link rel="stylesheet" href="../static/css/animate.css" th:href="@{/css/animate.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.0.2/css/swiper.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.0.2/css/swiper.min.css">
    <style type="text/css">
            .swiper-container {
      width: 100%;
      height: 300px;
      margin-left: auto;
      margin-right: auto;
    }
    .swiper-slide {
      background-size: cover;
      background-position: center;
    }
    .gallery-top {
      height: 80%;
      width: 100%;
    }
    .gallery-thumbs {
      height: 20%;
      box-sizing: border-box;
      padding: 10px 0;
    }
    .gallery-thumbs .swiper-slide {
      height: 100%;
      opacity: 0.4;
    }
    .gallery-thumbs .swiper-slide-thumb-active {
      opacity: 1;
    }
    </style>
</head>
<body>
<!-- 引入segment -->
<div th:insert="header_footer :: logo"></div>
<div th:insert="header_footer :: nav"></div>

<div class="ui small icon basic button" style="z-index: 1000; position: fixed; top: 92%; right: 1%;"><i class="angle pink down icon"></i></div>
<div class="ui popup top left transition hidden vertical icon basic buttons">
        <button class="ui button"><i class="angle pink down icon"></i></button>
        <button class="ui button"><i class="video icon"></i></button>
        <button class="ui button"><i class="info icon"></i></button>
        <button class="ui button"><i class="picture icon"></i></button>
        <button class="ui button"><i class="angle up pink icon"></i></button>
</div>

<div class="fixed_button ui small icon basic button" style="z-index: 1000; position: fixed; top: 92%; right: 1%;"><i class="th list pink icon"></i></div>
<div class="ui popup top left transition hidden vertical" style="z-index: 1000; position: fixed; top: 92%; right: 1%;">
    <div class="ui vertical icon menu">
        <a class="item">
            <i class="angle pink down icon scroll_to_bottom"></i>
        </a>
        <a class="item">
            <i class="video pink icon scroll_to_video"></i>
        </a>
        <a class="item">
            <i class="info pink icon scroll_to_desc"></i>
        </a>
        <a class="item">
            <i class="picture pink icon scroll_to_pic"></i>
        </a>
        <a class="item">
            <i class="angle up pink icon scroll_to_top"></i>
        </a>
    </div>
</div>

<div class="ui container">
    <!-- <div th:text="${phone.url}"></div> -->
    <div class="ui vertical pink" style="padding-top: 25px">
        <div class="ui container">
            <div class="ui stackable divided grid">
                <div class="six wide column">   
                    <div class="swiper-container gallery-top">
					    <div class="swiper-wrapper">
					        <div th:each="obj,stat:${phone.thumbPic}" class="swiper-slide">
					           <img th:src="${obj}" width="100%" alt="">
					        </div>
					    </div>
					    <div class="swiper-pagination"></div>
					    <div class="swiper-button-next swiper-button-blue"></div>
                        <div class="swiper-button-prev swiper-button-blue"></div>
                        
					</div>
					<div class="swiper-container gallery-thumbs">
					   <div class="swiper-wrapper">
                            <div th:each="obj,stat:${phone.thumbPic}" class="swiper-slide">
                               <img th:src="${obj}"  width="100%" alt="">
                            </div>
				        </div>
				    </div>
                </div>
                <div class="nine wide column" style="padding-left:50px; padding-top:20px;">
              
                    <div class="ui items">
                        <div class="item">
	                       <h4 th:text="${phone.name}" class="ui black header" style="font-size:17px">小米 红米Note5 全网通版 4GB+64GB 黑色 移动联通电信4G手机 双卡双待 拍照手机</h4>
	                    </div>
	                    <div class="ui divider"></div>
	                    <div class="item">
	                       <p class="ui" style="opacity: 0.5">红米国民品质，拍照专家 / AI双摄/5.99”全面屏 / 4000mAh大电量 / 超过10000 项严苛检测</p>
	                    </div>
	                    <div class="ui divider"></div>
	                     <div class="item">
		                    <div class="middle aligned content">
		                         <span class="ui pink header" style="font-size:25px;">¥</span>
		                         <span th:text="${prices.prices[0].priceValue}" class="ui pink header" style="font-size:50px;">1349</span>
		                    </div>
		                    <span style="opacity: 0.5">更新日期：[[${prices.prices[0].date}]]</span>
	                    </div>
	                    <div class="ui divider"></div>
	                    <div class="item" th:unless="${#lists.isEmpty(salePromotion.salePromotion[0].salePromotionValue)}">
	                       <div>
	                           <div style="opacity: 0.5">
	                               活动：
	                           </div>
	                           <div style="padding-left:35px;">
		                           <div th:each="obj,stat:${salePromotion.salePromotion[0].salePromotionValue}" th:text="${obj}" style="opacity: 0.8; margin-top:3px;" class="ui mini pink horizontal label">[换购] 购买1件可优惠换购热销商品 </div>
<!-- 		                       <div style="opacity: 0.8; margin-top:3px;" class="ui mini pink horizontal label">[换购] 购买1件可优惠换购热销商品 </div>
		                           <div style="opacity: 0.8; margin-top:3px;" class="ui mini pink horizontal label">[换购] 购买1件可优惠换购热销商品 </div>
		                           <div style="opacity: 0.8; margin-top:3px;" class="ui mini pink horizontal label">[换购] 购买1件可优惠换购热销商品 </div> -->
	                           </div>
	                       </div>
	                    </div>
	                    <div class="ui divider" th:unless="${#lists.isEmpty(salePromotion.salePromotion[0].salePromotionValue)}"></div>
	                    <div class="item">
                           <div>
                               <div style="opacity: 0.5">
                                   评价：
                               </div>
                               <div style="padding-left:35px; opacity: 0.8">
                                   <div class="ui pink image label" style="margin-top: 5px;">
						               <img src="/images/好评.png">
						                  <span th:text="${opinions.opinionValues[0].highNumber}">21000</span>
						           </div>
						           <div class="ui orange image label" style="margin-top: 5px;">
                                       <img src="/images/一般.png">
                                          <span th:text="${opinions.opinionValues[0].mediumNumber}">300</span>
                                   </div>
                                   <div class="ui teal image label" style="margin-top: 5px;">
                                       <img src="/images/差评.png">
                                          <span th:text="${opinions.opinionValues[0].lowNumber}">300</span>
                                   </div>
                                   <div class="ui yellow image label" style="margin-top: 5px;">
                                       <img src="/images/比例.png">
                                          <span th:text="${opinions.opinionValues[0].score}">96%</span>
                                   </div>
                               </div>
                           </div>
                        </div>
	                    
	                    
	                    <div class="ui divider" th:unless="${#lists.isEmpty(phone.hotSpot)}"></div>
                        <div class="item" th:unless="${#lists.isEmpty(phone.hotSpot)}">
                           <div>
                               <div style="opacity: 0.5">
                                   选购热点：
                               </div>
                               <div style="padding-left:35px;">
                                   <div th:each="obj,stat:${phone.hotSpot}" th:text="${obj}" style="opacity: 0.6; margin-top:3px;" class="ui mini red  horizontal label">人工智能</div>
<!--                               <div style="opacity: 0.6; margin-top:3px;" class="ui mini red  horizontal label">人脸识别 </div>
                                   <div style="opacity: 0.6; margin-top:3px;" class="ui mini red  horizontal label">快速充电 </div> -->
                               </div>
                           </div>
                        </div>
                        <div class="ui divider"></div>
                        <div class="item">
                           <div>
                               <div style="opacity: 0.5">
                                   印象标签：
                               </div>
                               <div style="padding-left:35px;">
                                   <div th:each="impress : ${impresses.impressValue[0]}" th:text="${impress}" style="opacity: 0.6; margin-top:3px;" class="ui mini grey  horizontal label">流畅至极40</div>
                               </div>
                           </div>
                           
                           
                        </div>
	                </div>
	                <div th:if="${collStatus} == 'notColl'" class="ui red left button coll" th:data-id="${phone._id}" data-url="/addToColl">加入收藏袋，降价收到短信通知</div>
	                <div th:if="${collStatus} == 'toLogin'" class="ui yellow left button coll" th:data-id="${phone._id}" data-url="/toLogin">登录后即可加入收藏袋</div>
	                <div th:if="${collStatus} == 'colled'" class="ui teal left button coll" th:data-id="${phone._id}" data-url="/cancelColl">已收藏</div>
	                </div>
            </div>
        </div>
    </div>
    <div th:if="${phone.videoUrl} != '暂无信息'" class="ui centered grid" style="margin-top:35px;">
        <h3 class="ui horizontal divider header scroll_video">
            <i class="video pink icon"></i>
            Video
        </h3>
        <div class="tablet fourteen wide computer column" style="padding: 0 10%; margin-top: 25px;">
	        <video width="100%" controls="controls" th:src="${phone.videoUrl}" src="https://jdvodoss.jcloudcache.com/vodtransgzp1251412368/7447398155075804237/v.f30.mp4?dockingId=cc5df8d5-25b2-486c-8592-0b0bd8699671&storageSource=3">
	        </video>
        </div>
    </div>
    <div class="ui centered grid" style="margin-top:35px;">
        <h3 style="margin-top:12px;" class="ui horizontal divider header scroll_desc">
            <i class="pink info circle icon"></i>
            Description
        </h3>
        <div class="tablet fourteen wide column">
            <table class="ui pink table" style="text-align: center; margin-top:10px;">
			  <tbody>
			     <tr>
                    <td style="width: 15%; background-color: #F0F0F0">品牌</td>
                    <td th:text="${phone.brand}" style="width: 35%;">小米(MI)</td>
                    <td style="width: 15%; background-color: #F0F0F0">型号</td>
                    <td th:text="${phone.model}" style="width: 35%;">红米Note5</td>
                 </tr>
                 <tr>
                    <td style="width: 15%; background-color: #F0F0F0">运行内存</td>
                    <td th:text="${phone.ram}">4GB</td>
                    <td style="width: 15%; background-color: #F0F0F0">机身内存</td>
                    <td th:text="${phone.rom}">64GB</td>
                 </tr>
                 <tr>
                    <td style="width: 15%; background-color: #F0F0F0">CPU芯片</td>
                    <td th:text="${phone.cpu}">骁龙636</td>
                    <td style="width: 15%; background-color: #F0F0F0">屏幕尺寸</td>
                    <td th:text="${phone.screenSize}">5.99</td>
                 </tr>
                <tr>
                    <td style="width: 15%; background-color: #F0F0F0">分辨率</td>
                    <td th:text="${phone.resolution}">2160*1080</td>
                    <td style="width: 15%; background-color: #F0F0F0">是否支持存储卡</td>
                    <td th:text="${phone.memoryCard}">支持MicroSD（SF）</td>
                 </tr>
                 <tr>
                    <td style="width: 15%; background-color: #F0F0F0">存储卡扩展</td>
                    <td th:text="${phone.maxMemSup}">128GB</td>
                    <td style="width: 15%; background-color: #F0F0F0">指纹解锁</td>
                    <td th:text="${phone.figer}">支持</td>
                 </tr>
                 <tr>
                    <td style="width: 15%; background-color: #F0F0F0">商品清单</td>
                    <td  th:text="${phone.packList}">暂无信息</td>
                    <td style="width: 15%; background-color: #F0F0F0">电池毫安数</td>
                    <td  th:text="${phone.battery}">4000mAh(typ)/3900mAh(min)</td>
                 </tr>
                 <tr>
                    <td style="width: 15%; background-color: #F0F0F0">前置摄像头</td>
                    <td th:text="${phone.fCamera}">1300万像素</td>
                    <td style="width: 15%; background-color: #F0F0F0">后置摄像头</td>
                    <td th:text="${phone.rCamera}">其他;1200+500万像素</td>
                 </tr> 
			  </tbody>
			</table>
        </div>
    </div>
    <div class="ui centered grid" style="margin-top:35px;">
        <h3 style="margin-top:12px;" class="ui horizontal divider header scroll_pic">
            <i class="pink picture circle icon"></i>
            Picture
        </h3>
        <div class="tablet sixteen wide column" style="margin-top:10px;">
            <img th:each="obj,stat:${phone.detailUrl}" th:src="@{/images/white-image.png}" src="../static/images/white-image.png" th:data-src="${obj}"  class="ui centered image">
<!--        <img class="ui centered image" src="https://img30.360buyimg.com/sku/jfs/t17704/346/895364005/399844/4afead79/5aafe02fN6c00dd75.jpg">
            <img class="ui centered image" src="https://img30.360buyimg.com/sku/jfs/t19330/244/903546884/220716/925cb915/5aafe02fNf957d947.jpg">
            <img class="ui centered image" src="https://img30.360buyimg.com/sku/jfs/t14479/42/2630517723/318389/dffa673f/5aafe02fN5a013c0d.jpg">
             -->
        </div>
    </div>
</div>
<div th:insert="header_footer :: footer"></div>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.2/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.3.3/dist/semantic.min.js" data-filtered="filtered"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.0.2/js/swiper.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.0.2/js/swiper.min.js"></script>
<script src="../static/js/swiper.min.js" th:src="@{/js/swiper.min.js}"></script>
<!-- 把header_footer中的script包裹进来 -->
<!--/*/<th:block th:replace="header_footer :: script">/*/-->
<!--/*/</th:block>/*/-->
<script>
var galleryThumbs = new Swiper('.gallery-thumbs', {
    spaceBetween: 10,
    slidesPerView: 4,
    loop: true,
    freeMode: true,
    loopedSlides: 5, //looped slides should be the same
    watchSlidesVisibility: true,
    watchSlidesProgress: true,
  });
  var galleryTop = new Swiper('.gallery-top', {
    spaceBetween: 10,
    loop:true,
    loopedSlides: 5, //looped slides should be the same
    navigation: {
      nextEl: '.swiper-button-next',
      prevEl: '.swiper-button-prev',
    },
    // 如果需要分页器
    pagination: {
        el: '.swiper-pagination',
    },
    thumbs: {
      swiper: galleryThumbs,
    },
  });

$(document).ready(function(){
    $('.search.icon').click(function(){
        search_value = $('input.prompt').val()
        //alert(search_value)
        //var keyword = [[${param.keyword}]] //这样可以获得param.keyword
        //window.location.href= 'http://www.baidu.com'
        //在JS中不能这么写了  @{/phoneToPrice?page=0&brand={brand}&ram={ram}&rom={rom}&hotSpot={hotSpot}&keyword={keyword}(brand=${obj},ram=${param.ram},rom=${param.rom},hotSpot=${param.hotSpot},keyword=${param.keyword})}
        window.location.href= '/phoneToPrice?keyword='+ search_value 
    })
})
</script>

<!-- Initialize Swiper -->
<script>
	$('.fixed_button').popup({
	    on : 'click',
	})
    
    
    $('img')
    .visibility({
        type       : 'image',
        transition : 'fade in',
        duration   : 1000
    });
	
    $(document).ready(function(){
        $('.scroll_to_top').click(function(){$('html,body').animate({scrollTop: '0px'}, 500);});
        $('.scroll_to_video').click(function(){$('html,body').animate({scrollTop:$('.scroll_video').offset().top}, 500);});
        $('.scroll_to_desc').click(function(){$('html,body').animate({scrollTop:$('.scroll_desc').offset().top}, 500);});
        $('.scroll_to_pic').click(function(){$('html,body').animate({scrollTop:$('.scroll_pic').offset().top}, 500);});
        $('.scroll_to_bottom').click(function(){$('html,body').animate({scrollTop:$('.footer').offset().top}, 500);}); 
    });
    
    $(document).ready(function() {
        $('.coll').click(function () {
            var button = $(this)
            var id = $(this).attr('data-id');
            var url = $(this).attr('data-url');
            $(this).addClass('loading disabled');
            if(url == '/toLogin')
            	window.location.href= '/toLogin' //如果是toLogin状态 就需要先去登录，剩下colled 和 notColl状态
            //alert(id);
            $.ajax({
                url : url,
                type: "post",
                data : {
                    id : id
                },
                success: function (data ,textStatus, jqXHR)
                    {
                        if(data == 'fail'){
                        	window.location.href= '/toLogin'
                        }
                        else if(data == 'success' && url == '/addToColl'){
                        	button.removeClass('red');
                        	//alert(button.text());
                        	button.text('已收藏');
                        	button.attr('data-url','/cancelColl')
                        	button.addClass('teal cancelColl');
                        }
                        else if(data == 'success' && url == '/cancelColl'){
                            button.removeClass('teal');
                            button.text('加入收藏袋，降价收到短信通知');
                            button.attr('data-url','/addToColl')
                            button.addClass('red');
                        }
                        button.removeClass('loading disabled');
                    }, 
               })
        })
    }
    )
    
</script>
</body>
</html>